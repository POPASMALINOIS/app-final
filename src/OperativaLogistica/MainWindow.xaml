<Window x:Class="OperativaLogistica.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Operativa Logística" Height="900" Width="1500">

    <DockPanel>

        <!-- Barra de menú (opcional, ajústala según lo que ya tenías) -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_Archivo">
                <MenuItem Header="Nueva pestaña" Click="NewTab_Click"/>
                <MenuItem Header="Cerrar pestaña" Click="CloseTab_Click"/>
                <Separator/>
                <MenuItem Header="Importar…" Click="Import_Click"/>
                <MenuItem Header="Exportar CSV…" Click="ExportCsv_Click"/>
                <MenuItem Header="Guardar PDF…" Click="SavePdf_Click"/>
                <Separator/>
                <MenuItem Header="Nueva jornada…" Click="NewDay_Click"/>
                <Separator/>
                <MenuItem Header="Salir" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Ayuda">
                <MenuItem Header="Acerca de…" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- DataGrid principal -->
        <DataGrid x:Name="dgOperaciones"
                  ItemsSource="{Binding SesionActual.Operaciones}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="True"
                  IsReadOnly="False"
                  DockPanel.Dock="Top"
                  Margin="6"
                  HeadersVisibility="Column"
                  GridLinesVisibility="All">

            <!-- Hook equivalente a ColumnWidthChanged: sobre el header -->
            <DataGrid.Resources>
                <Style TargetType="DataGridColumnHeader">
                    <EventSetter Event="SizeChanged" Handler="DataGrid_ColumnWidthChanged"/>
                </Style>
            </DataGrid.Resources>

            <DataGrid.Columns>

                <!-- Ordena/ajusta los DisplayIndex y Width a tu gusto -->
                <DataGridTextColumn Binding="{Binding Id}" Header="Id" Width="60" />
                <DataGridTextColumn Binding="{Binding Transportista}" Header="Transportista" Width="220" />
                <DataGridTextColumn Binding="{Binding Matricula}" Header="Matricula" Width="110" />
                <DataGridTextColumn Binding="{Binding Muelle}" Header="Muelle" Width="90" />
                <DataGridTextColumn Binding="{Binding Estado}" Header="Estado" Width="110" />
                <DataGridTextColumn Binding="{Binding Destino}" Header="Destino" Width="220" />

                <DataGridTextColumn Binding="{Binding Llegada}" Header="Llegada" Width="110" />
                <DataGridTextColumn Binding="{Binding LlegadaReal}" Header="LlegadaReal" Width="110" />
                <DataGridTextColumn Binding="{Binding SalidaReal}" Header="SalidaReal" Width="110" />
                <DataGridTextColumn Binding="{Binding SalidaTope}" Header="SalidaTope" Width="110" />

                <DataGridTextColumn Binding="{Binding Observaciones}" Header="Observaciones" Width="300" />
                <DataGridTextColumn Binding="{Binding Incidencias}" Header="Incidencias" Width="240" />

                <!-- Fecha (DateOnly) se muestra con ToString() por defecto; si quieres formato, usa StringFormat -->
                <DataGridTextColumn Binding="{Binding Fecha, StringFormat=\{0:yyyy-MM-dd\}}" Header="Fecha" Width="120" />

                <DataGridTextColumn Binding="{Binding Precinto}" Header="Precinto" Width="120" />

                <!-- Lex (bool) como CheckBox -->
                <DataGridCheckBoxColumn Binding="{Binding Lex}" Header="Lex" Width="60" />

                <!-- Lado como ComboBox (ItemsSource = Config.Lados; SelectedItem = Operacion.Lado) -->
                <DataGridComboBoxColumn Header="Lado"
                                        Width="140"
                                        SelectedItemBinding="{Binding Lado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        ItemsSource="{Binding DataContext.Config.Lados, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
